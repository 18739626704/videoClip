# 🎬 视频剪辑工具

一个可视化视频剪辑工具，支持视频预览、时间轴拖拽选择等功能。

## ✨ 功能特点

- 🎥 **视频预览**：直接在浏览器中播放预览视频
- ⏱️ **可视化时间轴**：拖拽滑块选择剪辑范围，点击跳转播放位置
- 📍 **快速定位**：使用当前播放位置快速设置开始/结束时间
- ✂️ **快速剪辑**：使用流复制模式，秒级完成剪辑
- 📂 **文件浏览器**：可视化选择文件，无需手动输入路径

## 📋 环境要求

1. **Node.js** 14.0 或更高版本
2. **FFmpeg** 5.1.x 或 4.4.x 版本（推荐）

### ⚠️ FFmpeg 版本说明

某些视频格式可能是非标准MPEG格式，**新版FFmpeg 7.x 对此解析可能失败**。

**推荐使用 FFmpeg 5.1 版本**：
- 下载地址：https://github.com/BtbN/FFmpeg-Builds/releases
- 找到类似 `ffmpeg-n5.1.x-win64-gpl.zip` 的文件下载

## 🚀 安装步骤

### 1. 下载 FFmpeg

1. 访问 https://github.com/BtbN/FFmpeg-Builds/releases
2. 下载 `ffmpeg-n5.1.4-2-xxx-win64-gpl.zip` 或类似版本
3. 解压到任意目录，例如 `D:\ffmpeg-5.1\`

### 2. 安装项目依赖

```bash
# 进入项目目录
cd videoClip

# 安装依赖
npm install
```

### 3. 启动服务

```bash
npm start
```

### 4. 打开浏览器

访问 http://localhost:3000

### 5. 配置 FFmpeg 路径

1. 点击右上角 ⚙️ 设置按钮
2. 点击"浏览..."按钮选择 FFmpeg 文件（例如 `ffmpeg.exe`）
3. 点击"测试 FFmpeg"确认可用
4. 保存设置

## 📖 使用说明

### 基本剪辑流程

1. **选择视频**：在左侧文件浏览器中导航到视频所在文件夹，点击视频文件
2. **预览视频**：视频会在右侧播放器中加载，可以播放预览
3. **设置时间范围**：
   - 🎯 **方式一**：拖拽时间轴上的绿色（开始）和橙色（结束）滑块
   - ⌨️ **方式二**：在下方输入框手动输入时间 `HH:MM:SS` 格式
   - 📍 **方式三**：播放到想要的位置，点击 📍 按钮使用当前播放位置
4. **预览片段**：点击"预览片段"按钮确认剪辑范围
5. **开始剪辑**：点击"开始剪辑"按钮
6. **查看结果**：剪辑完成后点击右上角 📁 打开输出目录

### 快捷预览按钮

- **预览开始点**：跳转到开始时间并播放
- **预览结束点**：跳转到结束时间前3秒并播放
- **预览片段**：从开始时间播放到结束时间

### 视频格式兼容性

如果视频格式浏览器不支持预览（显示"格式不支持预览"），仍可以：
1. 手动输入时间进行剪辑
2. 剪辑后的视频通常是标准格式，可以正常预览

### 重新编码模式

如果遇到剪辑后视频无法播放的情况，勾选"重新编码"选项。这会更慢但兼容性更好。

## 🔧 高级配置

配置文件 `config.json` 在项目根目录，包含：

```json
{
  "ffmpegPath": "D:\\ffmpeg-5.1\\bin\\ffmpeg.exe",
  "outputDir": "D:\\videoClip\\output"
}
```

## 📁 项目结构

```
videoClip/
├── server.js          # 后端服务
├── package.json       # 项目配置
├── config.json        # 运行时配置（自动生成）
├── output/            # 默认输出目录（自动创建）
├── public/            # 前端文件
│   ├── index.html     # 主页面
│   ├── style.css      # 样式
│   └── app.js         # 前端逻辑
└── README.md          # 说明文档
```

## ❓ 常见问题

### Q: 剪辑失败，提示 "dimensions not set"
A: 这是FFmpeg版本问题，请使用 5.1 或 4.4 版本。

### Q: 视频无法预览
A: 某些非标准格式（如海康CVR导出的视频）浏览器可能不支持预览，但不影响剪辑功能。

### Q: 视频时长显示为 N/A
A: 部分视频元数据可能不完整，但不影响剪辑。可以先尝试剪辑一小段测试。

### Q: 剪辑后视频无法播放
A: 勾选"重新编码"选项重新剪辑。

### Q: 如何分享给其他人使用？
A: 将整个 `videoClip` 文件夹和 FFmpeg 一起打包分享，接收者只需：
1. 安装 Node.js
2. 运行 `npm install` 和 `npm start`
3. 配置 FFmpeg 路径

## 📄 许可证

MIT License
